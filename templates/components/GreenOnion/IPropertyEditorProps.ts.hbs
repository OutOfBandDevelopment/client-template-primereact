import type { Control, FieldValues, UseFormSetValue, UseFormWatch, FieldErrors } from 'react-hook-form';

export type PropertyType = 
  | 'text' 
  | 'number' 
  | 'boolean' 
  | 'date' 
  | 'datetime' 
  | 'dropdown' 
  | 'multiselect' 
  | 'textarea' 
  | 'email' 
  | 'phone' 
  | 'url'
  | 'password'
  | 'color'
  | 'readonly';

export interface IPropertyDefinition<TEntity> {
  /** Field name from entity */
  field: keyof TEntity | string;
  /** Display label */
  label: string;
  /** Property type */
  type: PropertyType;
  /** Whether field is required */
  required?: boolean;
  /** Whether field is disabled */
  disabled?: boolean;
  /** Whether field is readonly */
  readonly?: boolean;
  /** Placeholder text */
  placeholder?: string;
  /** Help text shown below field */
  helpText?: string;
  /** Validation rules */
  rules?: Record<string, any>;
  /** Options for dropdown/multiselect (value/label pairs or async loader) */
  options?: { value: any; label: string }[] | (() => Promise<{ value: any; label: string }[]>);
  /** Dropdown component to use (for entity lookups) */
  dropdownComponent?: React.ComponentType<any>;
  /** MultiSelect component to use (for entity lookups) */
  multiSelectComponent?: React.ComponentType<any>;
  /** Min value for numbers */
  min?: number;
  /** Max value for numbers */
  max?: number;
  /** Step for numbers */
  step?: number;
  /** Number of rows for textarea */
  rows?: number;
  /** Custom render function */
  render?: (value: any, onChange: (value: any) => void, entity: TEntity) => React.ReactNode;
  /** Visibility condition */
  visible?: (entity: TEntity) => boolean;
  /** Grid column span (1-12) */
  colSpan?: number;
  /** Group name for organizing properties */
  group?: string;
}

export interface IPropertyGroup {
  /** Group name */
  name: string;
  /** Display label */
  label: string;
  /** Whether group is collapsible */
  collapsible?: boolean;
  /** Whether group is initially collapsed */
  collapsed?: boolean;
  /** Icon class */
  icon?: string;
}

export interface IPropertyEditorProps<TEntity, TFormValues extends FieldValues = FieldValues> {
  /** Entity being edited */
  entity?: TEntity | null;
  /** Property definitions */
  properties: IPropertyDefinition<TEntity>[];
  /** Property groups */
  groups?: IPropertyGroup[];
  /** React Hook Form control */
  control: Control<TFormValues>;
  /** React Hook Form setValue */
  setValue: UseFormSetValue<TFormValues>;
  /** React Hook Form watch */
  watch: UseFormWatch<TFormValues>;
  /** Form errors */
  errors?: FieldErrors<TFormValues>;
  /** Number of columns in grid (1-4) */
  columns?: 1 | 2 | 3 | 4;
  /** Whether form is in loading state */
  loading?: boolean;
  /** Whether form is disabled */
  disabled?: boolean;
  /** CSS class name */
  className?: string;
  /** Called when a field value changes */
  onFieldChange?: (field: keyof TEntity | string, value: any) => void;
  /** Layout mode */
  layout?: 'vertical' | 'horizontal';
  /** Show labels inline with inputs (horizontal layout) */
  labelWidth?: string;
}